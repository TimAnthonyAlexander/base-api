#!/usr/bin/env php
<?php

/**
 * Mason - BaseAPI CLI Tool
 * 
 * Lightweight bootstrap script that delegates to MasonBootstrap class.
 */

// Minimal inline autoloader locator (needed before we can load classes)
$locateAutoloader = function (): ?string {
    $paths = [
        getcwd() . '/vendor/autoload.php',
        __DIR__ . '/../vendor/autoload.php',
        __DIR__ . '/../../autoload.php',
        __DIR__ . '/../../../autoload.php'
    ];
    
    foreach ($paths as $path) {
        if (file_exists($path)) {
            return $path;
        }
    }
    
    return null;
};

$autoloader = $locateAutoloader();

if (!$autoloader) {
    echo "Error: Could not find composer autoloader.\n";
    echo "Please run 'composer install' first.\n";
    exit(1);
}

require_once $autoloader;

// Delegate everything to the bootstrap class
use BaseApi\Console\MasonBootstrap;

$baseAppPath = MasonBootstrap::detectBasePath();
$bootstrap = new MasonBootstrap($baseAppPath);
exit($bootstrap->run($argv));
